const products=[{id:1,name:"Nut",nutFree:!1,lactoseFree:!0,price:1.99,image:"https://i0.wp.com/post.healthline.com/wp-content/uploads/2019/11/chestnut-nut-nuts-peanuts-pistachio-cashew-1296x728-header-1296x728.jpg?w=1155&h=1528"},{id:2,name:"Milk",nutFree:!0,lactoseFree:!1,price:2.35,image:"https://post.greatist.com/wp-content/uploads/sites/2/2020/10/226177-grt-Does-Drinking-Milk-Before-Bed-Really-Help-You-Sleep-1200x628-Facebook-1200x628.jpg"},{id:3,name:"Chicken",nutFree:!0,lactoseFree:!0,price:10,image:"https://fitfoodiefinds.com/wp-content/uploads/2020/07/chicken-chop-salad-1-1sq.jpg"},{id:4,name:"Almond Milk",nutFree:!1,lactoseFree:!0,price:5,image:"https://media.istockphoto.com/photos/almond-milk-in-glass-with-almonds-on-background-square-format-picture-id851979124?k=6&m=851979124&s=170667a&w=0&h=PbIu8byNBcBxizNr8LrlV7TShHhY3a4Qkc1vbPKaKTM="},{id:5,name:"Tomato",nutFree:!0,lactoseFree:!0,price:5,image:"https://toriavey.com/images/2012/04/Tomatoes-Main.jpg"},{id:6,name:"Cheeze",nutFree:!0,lactoseFree:!1,price:9,image:"https://www.noracooks.com/wp-content/uploads/2020/05/square.jpg"},{id:7,name:"Ketchup",nutFree:!0,lactoseFree:!0,price:5.5,image:"https://www.livingsmartandhealthy.com/wp-content/uploads/2020/07/Tomato-Ketchup-with-fresh-tomatoes10-500x500.jpg"},{id:8,name:"Bacon",nutFree:!0,lactoseFree:!0,price:7.75,image:"https://hips.hearstapps.com/hmg-prod.s3.amazonaws.com/images/delish-190621-air-fryer-bacon-0035-landscape-pf-1567632709.jpg?crop=0.645xw:0.967xh;0.170xw,0.0204xh&resize=480:*"},{id:9,name:"Granola Bar",nutFree:!1,lactoseFree:!0,price:3.5,image:"https://thebigmansworld.com/wp-content/uploads/2019/03/vegan-granola-bars3.jpg"},{id:10,name:"Cabbage",nutFree:!0,lactoseFree:!0,price:1.5,image:"https://www.farmersalmanac.com/wp-content/uploads/2020/11/cabbage-health-benefits-AdobeStock_173509538.jpeg"}];let cart=new Set;const cartKey="cart",initialLoadCart=()=>{var e=localStorage.getItem(cartKey);e&&(cart=new Set(JSON.parse(e))),updateNumCartElement(cart.size)},addToCart=e=>{cart.add(e),updateNumCartElement(cart.size),localStorage.setItem(cartKey,JSON.stringify([...cart]))},removeFromCart=e=>{cart.delete(e),updateNumCartElement(cart.size),localStorage.setItem(cartKey,JSON.stringify([...cart]))},clearCart=()=>{cart.clear(),localStorage.removeItem(cartKey),updateNumCartElement(0)},updateNumCartElement=e=>{document.getElementById("cart-num").innerText=e||""},createProductElement=(e,t=handleProductClick)=>{const c=document.createElement("div");c.classList.add("product");const a=document.createElement("div");a.classList.add("product__image"),a.style.backgroundImage=`url(${e.image})`,c.appendChild(a);const r=document.createElement("i");r.className+=`material-icons product__button ${e.selected?"product__button--selected":""}`,r.innerHTML=e.selected?"remove":"add_shopping_cart",r.addEventListener("click",t(e.id)),a.appendChild(r);const o=document.createElement("div");o.classList.add("product__info");const d=document.createElement("h3");d.classList.add("product__name"),d.innerHTML=e.name;const n=document.createElement("p");return n.classList.add("product__price"),n.innerHTML="$"+e.price.toFixed(2),o.appendChild(d),o.appendChild(n),c.appendChild(o),c},handleProductClick=c=>e=>{const t=e.target;t.classList.contains("product__button--selected")?(t.innerHTML="add_shopping_cart",removeFromCart(c)):(t.innerHTML="remove",addToCart(c)),t.classList.toggle("product__button--selected")},populateProducts=(t,e,c)=>{e.forEach(e=>{e=createProductElement(e,c);t.appendChild(e)})},bindProductClick=(e,t)=>{document.querySelectorAll(e).forEach(e=>{e.addEventListener("click",t)})},checkoutProducts=document.getElementById("checkout-products"),checkoutReciept=document.getElementById("checkout-reciept");let selectedProducts=[];const handleCheckoutTabClick=()=>{selectedProducts=filterSelectedProducts(products,cart),checkoutProducts.innerHTML="",populateProducts(checkoutProducts,selectedProducts,handleCheckoutProductClick),populateRecipet(selectedProducts)},filterSelectedProducts=(e,t)=>{const c=[];return e.forEach(e=>{t.has(e.id)&&(e.selected=!0,c.push(e))}),c},populateRecipet=e=>{checkoutReciept.innerHTML="";let t=0;e.forEach(e=>{checkoutReciept.innerHTML+=`
            <div class="purchase-item">
                <h3 class="purchase-item__name">${e.name}</h3>
                <p class="purchase-item__price">$${e.price.toFixed(2)}</p>
            </div>
            `,t+=e.price}),checkoutReciept.innerHTML+=`<h2 class="checkout-reciept__total">$${t.toFixed(2)}</h2>`},handleCheckoutProductClick=c=>e=>{handleProductClick(c)(e);const t=e.target.parentElement.parentElement;t.classList.add("product-remove"),t.addEventListener("transitionend",()=>{t.remove()},{once:!0}),selectedProducts=selectedProducts.filter(e=>e.id!==c),populateRecipet(selectedProducts)},handleCheckout=()=>{clearCart(),selectedProducts=[],checkoutProducts.innerHTML="",populateRecipet(selectedProducts)},shopProducts=document.getElementById("shop-products"),filter=document.getElementById("filter"),tabs=document.querySelectorAll(".tab__link"),shopTab=document.getElementById("shop-tab"),checkoutTab=document.getElementById("checkout-tab"),checkoutButton=document.getElementById("checkout-button"),addSelectedProperty=e=>e.map(e=>({...e,selected:cart.has(e.id)})),applyFilter=e=>{const t=new FormData(e);var c=t.getAll("category"),e=t.get("price");shopProducts.innerHTML="",0<c.length||e?(e=filterProducts(products,c,e),populateProducts(shopProducts,addSelectedProperty(e))):populateProducts(shopProducts,addSelectedProperty(products))},filterProducts=(e,t,c)=>{const a=e.filter(e=>{for(category of t){if("lactose-free"==category&&!e.lactoseFree)return!1;if("nut-free"==category&&!e.nutFree)return!1}return!0});return"low-to-high"==c?a.sort((e,t)=>e.price-t.price):"high-to-low"==c&&a.sort((e,t)=>t.price-e.price),a},handleFilterSubmit=e=>{e.preventDefault(),applyFilter(e.target)},handleTabClick=e=>{const t=document.querySelector(".active-tab"),c=document.getElementById(e.target.value);t.id!==c.id&&(t.classList.remove("active-tab"),t.classList.add("inactive-tab"),c.classList.add("active-tab"),c.classList.remove("inactive-tab"))},handleShopTabClick=()=>{applyFilter(filter)};initialLoadCart(),populateProducts(shopProducts,addSelectedProperty(products)),filter.addEventListener("submit",handleFilterSubmit),shopTab.addEventListener("click",handleShopTabClick),checkoutTab.addEventListener("click",handleCheckoutTabClick),tabs.forEach(e=>e.addEventListener("click",handleTabClick)),checkoutButton.addEventListener("click",handleCheckout);